year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration))+
geom_errorbar(mapping = aes(y = Value.SSB, xmin = ci_low, xmax = ci_high))+
geom_hline(yintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = iteration, y = Value.SSB))+
geom_errorbar(mapping = aes(x = iteration, ymin = ci_low, ymax = ci_high))+
geom_hline(yintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration))+
geom_errorbar(mapping = aes(x = Value.SSB, ymin = ci_low, ymax = ci_high))+
geom_hline(yintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration))+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high))+
geom_hline(yintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration))+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high))
geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_wrap(~scenario)
geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb))+
geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_wrap(~scenario)
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration))+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high))+
geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_wrap(~scenario)
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration))+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high))+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_wrap(~scenario)
windows()
scneario_2_conf_int <- year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
#conditionally count values : 1 if true val in , 0 if out
mutate(true_val_in = ifelse( true_ssb>= ci_low &  true_ssb <= ci_high,1,0))%>%
group_by(years,sd_level,scenario)%>%
summarise(total_ci_90 = sum(true_val_in,na.rm = T))%>%
ggplot(aes(x = years, y = total_ci_90))+
geom_bar(stat = "identity")+
facet_wrap(~sd_level)+
scale_y_continuous(breaks = seq(0,100,10))+
geom_hline(yintercept= 90, lty = 2)+
ggtitle("Scenario 2: Times treu value in 90 CI")
windows()
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration))+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high))+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_wrap(~scenario)+
geom_vline(xintercept = true_ssb_scenario)
true_ssb_scenario
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration))+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high))+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_wrap(~scenario)+
geom_vline(xintercept = true_ssb)
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
filter(scenario == "sd_0.025_yrs1")%>%
ggplot(aes(x = iteration, y = Value.SSB-true_ssb))+
geom_point()+
geom_hline(yintercept = 0, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration, alpha = 0.5))+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high, alpha = 0.5))+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_wrap(~scenario)+
geom_vline(xintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration, alpha = 0.3))+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high, alpha = 0.3))+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_wrap(~scenario)+
geom_vline(xintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_wrap(~scenario)+
geom_vline(xintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(sd_level ~ year)+
geom_vline(xintercept = true_ssb, col = "red")
year
names(year_scalar)
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(sd_level ~ years)+
geom_vline(xintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(years ~ sd_level)+
geom_vline(xintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(years ~ sd_level)+
geom_vline(xintercept = true_ssb, col = "red")
windows()
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(years ~ sd_level)+
geom_vline(xintercept = true_ssb, col = "red")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(years ~ sd_level)+
geom_vline(xintercept = true_ssb, col = "red")+
xlab("SSB_100")
plot <- year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(years ~ sd_level)+
geom_vline(xintercept = true_ssb, col = "red")+
xlab("SSB_100")
getwd()
?ggsave
ggsave("plot.pdf")
plot <- year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(years ~ sd_level)+
geom_vline(xintercept = true_ssb, col = "red")+
xlab("SSB_100 90 CI")
ggsave("plot.pdf")
plot <- year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(years ~ sd_level)+
geom_vline(xintercept = true_ssb, col = "red")+
xlab("SSB_100 90 CI")
ggsave("plot.pdf")
sample_size_results
scalar_res_years <- read.csv("E:/compu_lab_pc/tylers_years_sim/ss3sim_scalar.csv")
scalar_res_years <- read.csv("E:/compu_lab_pc/tyler_years_sim/ss3sim_scalar.csv")
years_scalar <- scalar_res_years
true_ssb_scenario <- year_scalar%>%
filter(model_run == "om",
year == 100)%>%
group_by(scenario)%>%
summarise(mean_true_ssb = mean(Value.SSB))
true_ssb_scenario
year_scalar <- scalar_res_years
true_ssb_scenario <- year_scalar%>%
filter(model_run == "om",
year == 100)%>%
group_by(scenario)%>%
summarise(mean_true_ssb = mean(Value.SSB))
year_scalar
### PLots for years
year_dq <- "E:/compu_lab_pc/tyler_years_sim/ss3sim_dq.csv"
year_dq%>%
filter(model_run == "om",
year == 100)%>%
group_by(scenario)%>%
summarise(mean_true_ssb = mean(Value.SSB))
names(dq)
names(year_dq)
### PLots for years
year_dq <- read.csv("E:/compu_lab_pc/tyler_years_sim/ss3sim_dq.csv")
year_dq%>%
filter(model_run == "om",
year == 100)%>%
group_by(scenario)%>%
summarise(mean_true_ssb = mean(Value.SSB))
true_ssb_scenario <- year_dq%>%
filter(model_run == "om",
year == 100)%>%
group_by(scenario)%>%
summarise(mean_true_ssb = mean(Value.SSB))
true_ssb <- mean(true_ssb_scenario$mean_true_ssb)
## Plot 1 SSB
scenario_2_ssb <- year_scalar%>%
filter(model_run == "em",
year == 100)%>%
ggplot(aes(x = years, y = Value.SSB))+
geom_boxplot()+
geom_hline(aes(yintercept = true_ssb))+
facet_wrap(~sd_level)+
ggtitle("Scenario 2: SSB_100")+
ylab("SSB_100")
sd_levls <- rep(rep(c(0.025,0.05,0.1,0.125,0.15),each = 70800))
years <- rep(rep(c(1,10,2,5),each = 17700),5)
year_scalar%>%
arrange(as.factor(scenario))%>%
mutate(sd_level = factor(sd_levls, levels = c(0.025,0.05,0.1,0.125,0.15)),
years = factor(years, levels = c(1,2,5,10)))->year_scalar
#Add sd level and years
sd_levls <- rep(rep(c(0.025,0.05,0.1,0.125,0.15),each = 70800))
years <- rep(rep(c(1,10,2,5),each = 17700),5)
year_scalar%>%
arrange(as.factor(scenario))%>%
mutate(sd_level = factor(sd_levls, levels = c(0.025,0.05,0.1,0.125,0.15)),
years = factor(years, levels = c(1,2,5,10)))->year_scalar
table(year_scalar$scenario)
scalar_res_years <- read.csv("E:/compu_lab_pc/tyler_years_sim/ss3sim_scalar.csv")
year_scalar <- scalar_res_years
table(year_scalar$scenario)
View(year_scalar)
#Pull in the data files
year_results <- readRDS("year_results.RDATA")
table(year_results$scenario)
year_scalar <- tibble(year_results[[1]])
table(year_results$scenario)
table(year_scalar$scenario)
View(years_scalar)
scalar_res_years <- read.csv("E:/compu_lab_pc/tyler_years_sim/ss3sim_scalar.csv")
scalar_res_years
sample_size_results
scalar_res_years <- read.csv("E:/compu_lab_pc/tyler_years_sim/ss3sim_dq.csv")
scalar_res_years
year_scalar <- scalar_res_years
#Add sd level and years
sd_levls <- rep(rep(c(0.025,0.05,0.1,0.125,0.15),each = 70800))
years <- rep(rep(c(1,10,2,5),each = 17700),5)
year_scalar%>%
arrange(as.factor(scenario))%>%
mutate(sd_level = factor(sd_levls, levels = c(0.025,0.05,0.1,0.125,0.15)),
years = factor(years, levels = c(1,2,5,10)))->year_scalar
table(year_scalar$scenario)
true_ssb_scenario <- year_dq%>%
filter(model_run == "om",
year == 100)%>%
group_by(scenario)%>%
summarise(mean_true_ssb = mean(Value.SSB))
true_ssb <- mean(true_ssb_scenario$mean_true_ssb)
true_ssb
## Plot 1 SSB
scenario_2_ssb <- year_scalar%>%
filter(model_run == "em",
year == 100)%>%
ggplot(aes(x = years, y = Value.SSB))+
geom_boxplot()+
geom_hline(aes(yintercept = true_ssb))+
facet_wrap(~sd_level)+
ggtitle("Scenario 2: SSB_100")+
ylab("SSB_100")
## Plot 1 SSB
scenario_2_ssb <- year_scalar%>%
filter(model_run == "em",
year == 100)%>%
ggplot(aes(x = years, y = Value.SSB))+
geom_boxplot()+
geom_hline(aes(yintercept = true_ssb))+
facet_wrap(~sd_level)+
ggtitle("Scenario 2: SSB_100")+
ylab("SSB_100")
#PLot 2 CV
scenario_2_cv <- year_scalar%>%
filter(model_run == "em",
year == 100)%>%
group_by(sd_level,years)%>%
summarise(cv = (StdDev.SSB/Value.SSB)*100)%>%
ggplot(aes(x = years, y = cv))+
geom_boxplot()+
facet_wrap(~sd_level)+
ylab("CV of SSB_100")+
ggtitle("Scenario 2: CV of SSB_100")
scenario_2_ssb
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
group_by(sd_level,years)%>%
summarise(cv = (StdDev.SSB/Value.SSB)*100)%>%
ggplot(aes(x = years, y = cv))+
geom_boxplot()+
facet_wrap(~sd_level)+
ylab("CV of SSB_100")+
ggtitle("Scenario 2: CV of SSB_100")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
#conditionally count values : 1 if true val in , 0 if out
mutate(true_val_in = ifelse( true_ssb>= ci_low &  true_ssb <= ci_high,1,0))%>%
group_by(years,sd_level,scenario)%>%
summarise(total_ci_90 = sum(true_val_in,na.rm = T))%>%
ggplot(aes(x = years, y = total_ci_90))+
geom_bar(stat = "identity")+
facet_wrap(~sd_level)+
scale_y_continuous(breaks = seq(0,100,10))+
geom_hline(yintercept= 90, lty = 2)+
ggtitle("Scenario 2: Times treu value in 90 CI")
year_scalar%>%
filter(model_run == "em",
year == 100)%>%
#calculate CI s
mutate(ci_low = Value.SSB-1.645*(StdDev.SSB/sqrt(1)),
ci_high = Value.SSB+1.645*(StdDev.SSB/sqrt(1)))%>%
# filter(scenario == "sd_0.025_yrs1")%>%
ggplot()+
geom_point(mapping = aes(x = Value.SSB, y = iteration), alpha = 0.3)+
geom_errorbar(mapping = aes(y = iteration, xmin = ci_low, xmax = ci_high), alpha = 0.3)+
# geom_point(mapping = aes(x = iteration, y = ci_low, col = as.factor(iteration)))+
# geom_point(mapping = aes(x = iteration, y = ci_high, col = as.factor(iteration)))+
geom_vline(xintercept = true_ssb)+
facet_grid(years ~ sd_level)+
geom_vline(xintercept = true_ssb, col = "red")+
xlab("SSB_100 90 CI")
true_ssb_scenario
scenario_2_ssb
scenario_2_cv
scneario_2_conf_int
